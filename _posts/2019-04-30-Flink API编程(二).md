---
layout: post
title: Flink API编程（二）
tags: [flink]
---

## Flink API编程（事件时间和水印）
支持事件时间的流处理器需要一种方法来衡量事件时间的进度,比如按照10分钟构建的窗口，需要知道当事件时间超过10分钟后需要进行通知，是的算子可以结束本轮运算。Flink中，这个衡量事件时间进度的机制是Watermarks。
event time(事件时间)和Watermark(水印)是Flink的两个核心概念，是Flink 实现 乱序处理、窗口计算的基础。

### 1 事件时间和水印(Event time and WaterMarks)
#### 1.1 event time
Flink 支持三种类型的时间：
* `event time`:事件时间，流上的事件真是发生的时间
* `ingestion time`:摄入时间，流上的事件进入Flink时的时间
* `Processing time`:处理时间，Flink的算子在处理该事件的时间
大多数场景使用`event time`，因为即使应用挂掉或者failover，重新运算后的结果仍能保持一致。Flink默认使用Processing time，如果需要使用其他类型的时间，可以按照如下显示指定：
```
final StreamExecutionEnvironment env =
  StreamExecutionEnvironment.getExecutionEnvironment();
env.setStreamTimeCharacteristic(TimeCharacteristic.EventTime);

```
指定`event time`后，我们需要在代码里实现一个`时间提取器`(Timestamp Extractor)和`水印生成器`(Watermark Generator)，这样Flink才能实现对`event time`的跟踪处理 

#### 1.2 watermarks


### 2 窗口(Windows)

### 3 Lab2 窗口练习